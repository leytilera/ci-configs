kind: pipeline
type: docker
name: release

steps:
    - name: build
      image: ghcr.io/getzola/zola:v0.15.3
      commands:
        - zola build
    - name: upload
      image: appleboy/drone-scp
      settings:
        host: git.tilera.org
        username: webmaster
        password: 
          from_secret: web_pw
        port: 2220
        target: /home/webmaster/${DRONE_REPO_OWNER}/${DRONE_REPO_NAME}
        source: public/*
        rm: true
        strip_components: 1
      when:
          branch: master
          event: push
      depends_on:
          - build